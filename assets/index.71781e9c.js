import{o as u,c as h,r as l,a as X,M as D,d as B,b as v,e as y,n as Z,w as i,f as a,u as m,g as f,I as U,h as L,t as $,i as M,j as ee,k as P,F as O,l as H,m as te,p as ne,q as se,s as oe,v as re,x as ae,y as ie,z as ce,A as le,B as ue,C as de,D as me,E as _e,G as pe}from"./vendor.26126477.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();const S=(e,n)=>{const t=e.__vccOpts||e;for(const[r,o]of n)t[r]=o;return t},fe={};function he(e,n){const t=l("router-view");return u(),h(t)}const ge=S(fe,[["render",he]]),ve="modulepreload",ye=function(e){return"/Vue3-admin-demo/"+e},T={},A=function(n,t,r){if(!t||t.length===0)return n();const o=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=ye(s),s in T)return;T[s]=!0;const c=s.endsWith(".css"),g=c?'[rel="stylesheet"]':"";if(!!r)for(let _=o.length-1;_>=0;_--){const p=o[_];if(p.href===s&&(!c||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${g}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":ve,c||(d.as="script",d.crossOrigin=""),d.href=s,document.head.appendChild(d),c)return new Promise((_,p)=>{d.addEventListener("load",_),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>n())},be="https://mock.apifox.cn/m1/1504786-0-default",b=X.create({baseURL:be,timeout:6e4}),Se="Bearer ";b.interceptors.request.use(e=>{const n=w();return n.token&&e.headers&&(e.headers.Authorization=Se+n.token),e});b.interceptors.response.use(e=>e.data,async e=>{var t,r,o;return((t=e.response)==null?void 0:t.data)&&await D.error(e.message),(((r=e.response)==null?void 0:r.status)===401||((o=e.response)==null?void 0:o.status)===403)&&await w().logout(),Promise.reject(e)});const we=e=>b.post("/tokens",e),Re={createToken:we},ke=()=>b.get("users/me"),Ee=e=>b.get("/users",{params:e}),Ue=e=>b.post("/users",e),Le=(e,n)=>b.post(`/user/${e}`,n),$e={me:ke,list:Ee,create:Ue,edit:Le},q=(e,n)=>e.filter(t=>(t.children&&(t.children=q(t.children,n)),!t.meta||t.meta&&(!t.meta.permission||t.meta.permission&&n.includes(t.meta.permission)))),z=e=>{const n=[];return e.forEach(t=>{t.children&&n.push(...z(t.children)),t.name&&n.push(t.name)}),n},I=B("permission",{state:()=>({routes:[]}),persist:!0,actions:{generateRoutes(e,n=!1){this.routes=n?V:q(V,e)}},getters:{menuRoutes(){var e;return(e=this.routes.find(n=>n.name===G))==null?void 0:e.children},permissionRouteNamesList(){return this.routes?z(this.routes):[]}}}),x=B("user",{state:()=>({currentUser:null}),persist:!0,actions:{async fetchCurrentUser(){this.currentUser=await $e.me(),I().generateRoutes(this.currentUser.permissions)}}}),w=B("app",{state:()=>({token:"",menuCollapse:!1}),persist:!0,actions:{async login(e){this.token=await Re.createToken(e)},async logout(){const e=x();this.token="",e.$reset()}}}),xe=v({__name:"CollapseButton",props:{collapse:{type:Boolean,required:!0}},emits:["update:collapse"],setup(e){return(n,t)=>(u(),y("div",{class:Z(["collapse-button",{collapse:!e.collapse}]),onClick:t[0]||(t[0]=r=>n.$emit("update:collapse",!e.collapse))},null,2))}});const Ce=S(xe,[["__scopeId","data-v-9cc43660"]]),Ae={class:"operation-area"},Oe=v({__name:"header",setup(e){const n=x(),t=w(),r=M(),o=ee(),s=async({value:c})=>{switch(c){case"logout":await t.logout(),await r.push({name:"login",params:{redirect:o.fullPath}});break}};return(c,g)=>{const k=l("t-button"),d=l("t-dropdown"),_=l("t-header");return u(),h(_,{class:"header"},{default:i(()=>[a(Ce,{collapse:m(t).menuCollapse,"onUpdate:collapse":g[0]||(g[0]=p=>m(t).menuCollapse=p)},null,8,["collapse"]),f("div",Ae,[a(d,{options:[{content:"logout",value:"logout"}],"min-column-width":112,onClick:s},{default:i(()=>[a(k,{variant:"text"},{icon:i(()=>[a(m(U),{name:"user"})]),default:i(()=>[L(" "+$(m(n).currentUser&&m(n).currentUser.nickname),1)]),_:1})]),_:1})])]),_:1})}}});const Ve=S(Oe,[["__scopeId","data-v-44220a82"]]),Be=v({__name:"SidebarItem",props:{item:{type:Object,default:null}},setup(e){return(n,t)=>{const r=l("t-menu-item"),o=l("sidebar-item",!0),s=l("t-submenu");return u(),y(O,null,[e.item&&!e.item.children?(u(),h(r,{key:0,value:e.item.name,to:{name:e.item.name}},{icon:i(()=>[a(m(U),{name:e.item.meta.icon},null,8,["name"])]),default:i(()=>[L(" "+$(e.item.meta.title),1)]),_:1},8,["value","to"])):P("",!0),e.item&&e.item.children?(u(),h(s,{key:1,value:e.item.name,title:e.item.meta.title},{icon:i(()=>[a(m(U),{name:e.item.meta.icon},null,8,["name"])]),default:i(()=>[(u(!0),y(O,null,H(e.item.children,c=>(u(),h(o,{key:c.name,item:c},null,8,["item"]))),128))]),_:1},8,["value","title"])):P("",!0)],64)}}}),Ie=v({__name:"sidebar",setup(e){const n=w(),t=I();return(r,o)=>{const s=l("t-menu"),c=l("t-aside");return u(),h(c,{width:m(n).menuCollapse?"64px":"232px"},{default:i(()=>[a(s,{collapsed:m(n).menuCollapse,defaultValue:r.$route.name},{default:i(()=>[(u(!0),y(O,null,H(m(t).menuRoutes,g=>(u(),h(Be,{key:g.name,item:g},null,8,["item"]))),128))]),_:1},8,["collapsed","defaultValue"])]),_:1},8,["width"])}}}),Pe=v({__name:"layout",setup(e){return(n,t)=>{const r=l("router-view"),o=l("t-content"),s=l("t-footer"),c=l("t-layout");return u(),y("div",null,[a(c,{class:"main-layout"},{default:i(()=>[a(Ie),a(c,null,{default:i(()=>[a(Ve),a(o,{class:"content-layout"},{default:i(()=>[a(r)]),_:1}),a(s,{style:{"text-align":"center"}},{default:i(()=>[L("Copyright @ 2022-2023 Brian-Admin")]),_:1})]),_:1})]),_:1})])}}});const Te=S(Pe,[["__scopeId","data-v-39e500b9"]]),Ne=e=>(se("data-v-316e5960"),e=e(),oe(),e),De={class:"login-container"},Me={class:"content"},He=Ne(()=>f("h1",null,"Brian Admin",-1)),qe=v({__name:"index",setup(e){const n=te({username:"",password:""}),t={username:[{required:!0,message:"Username must be filled"}],password:[{required:!0,message:"Password must be filled"}]},r=w(),o=x(),s=ne(!1),c=M(),g=async({validateResult:k})=>{if(k===!0){s.value=!0;try{await r.login(n),await o.fetchCurrentUser(),await D.success("Successfully login"),await c.push({name:"dashboard"})}finally{s.value=!1}}};return(k,d)=>{const _=l("t-input"),p=l("t-form-item"),Y=l("t-button"),J=l("t-form"),Q=l("t-card");return u(),y("div",De,[f("div",Me,[a(Q,null,{default:i(()=>[He,a(J,{ref:"form",data:n,rules:t,class:"login-form",colon:!0,"label-width":0,onSubmit:g},{default:i(()=>[a(p,{name:"username"},{default:i(()=>[a(_,{modelValue:n.username,"onUpdate:modelValue":d[0]||(d[0]=C=>n.username=C),clearable:"",placeholder:"Please type your Username"},{"prefix-icon":i(()=>[a(m(U),{name:"desktop"})]),_:1},8,["modelValue"])]),_:1}),a(p,{name:"password"},{default:i(()=>[a(_,{modelValue:n.password,"onUpdate:modelValue":d[1]||(d[1]=C=>n.password=C),type:"password",clearable:"",placeholder:"Please type your Password"},{"prefix-icon":i(()=>[a(m(U),{name:"lock-on"})]),_:1},8,["modelValue"])]),_:1}),a(p,null,{default:i(()=>[a(Y,{theme:"primary",type:"submit",block:"",loading:s.value},{default:i(()=>[L("Login")]),_:1},8,["loading"])]),_:1})]),_:1},8,["data"])]),_:1})])])}}});const ze=S(qe,[["__scopeId","data-v-316e5960"]]),Fe={};function je(e,n){const t=l("router-view");return u(),h(t)}const Ge=S(Fe,[["render",je]]),F="/Vue3-admin-demo/assets/not-found.c2e9c2e1.png",We={class:"main"},Ke={class:"content"},Ye=f("img",{src:F},null,-1),Je={class:"info"},Qe={class:"title"},Xe={class:"description"},j=v({__name:"ErrorPage",props:{title:{default:"Unknown error"},description:{default:"Oops...it seems like we lost this page"}},setup(e){return(n,t)=>{const r=l("t-button");return u(),y("div",We,[f("div",Ke,[re(n.$slots,"image",{},()=>[Ye]),f("div",Je,[f("div",Qe,$(e.title),1),f("div",Xe,$(e.description),1),a(r,{onClick:t[0]||(t[0]=o=>n.$router.replace({path:"/"}))},{default:i(()=>[L("Back to homepage")]),_:1})])])])}}});const Ze=f("img",{src:F},null,-1),et=v({__name:"not-found",setup(e){return(n,t)=>(u(),h(j,{title:"404 Page not found",description:"Sorry, the page does not exist"},{image:i(()=>[Ze]),_:1}))}}),tt="/Vue3-admin-demo/assets/not-allowed.95b00d4e.png",nt=f("img",{src:tt},null,-1),st=v({__name:"not-allowed",setup(e){return(n,t)=>(u(),h(j,{title:"403 Access denied",description:"You are not authorized to access this page, please reach out to webmaster"},{image:i(()=>[nt]),_:1}))}});var E=(e=>(e.DASHBOARD="dashboard",e.USER="user",e.USER_LIST="user:list",e.USER_LIST_CREATE="user:list:create",e.USER_LIST_EDIT="user:list:edit",e.USER_ROLES="user:roles",e.USER_ROLES_CREATE="user:roles:create",e.USER_ROLES_EDIT="user:roles:edit",e))(E||{});const it=[{label:"Console",value:"dashboard"},{label:"User",value:"user",children:[{label:"User management",value:"user:list",children:[{label:"Create user",value:"user:list:create"},{label:"Edit user",value:"user:list:edit"}]},{label:"Role management",value:"user:roles",children:[{label:"Create role",value:"user:roles:create"},{label:"Edit role",value:"user:roles:edit"}]}]}],G="menuRoot",V=[{path:"/",name:G,component:Te,redirect:"dashboard",children:[{name:"dashboard",path:"dashboard",component:()=>A(()=>import("./index.cdc1ff2a.js"),["assets/index.cdc1ff2a.js","assets/vendor.26126477.js","assets/vendor.b45df649.css","assets/index.8bf147b2.css"]),meta:{permission:E.DASHBOARD,title:"Dashboard",icon:"dashboard"}},{name:"user",path:"user",component:Ge,meta:{title:"Users",icon:"usergroup",permission:E.USER},redirect:{name:"user-list"},children:[{name:"user-list",path:"list",component:()=>A(()=>import("./index.bce2d0c7.js"),["assets/index.bce2d0c7.js","assets/useEditDialog.03c11ef1.js","assets/vendor.26126477.js","assets/vendor.b45df649.css"]),meta:{title:"Users Management",icon:"user",permission:E.USER_LIST}},{name:"role-list",path:"roles",component:()=>A(()=>import("./roles.bf51005b.js"),["assets/roles.bf51005b.js","assets/useEditDialog.03c11ef1.js","assets/vendor.26126477.js","assets/vendor.b45df649.css"]),meta:{title:"Roles Management",permission:E.USER_ROLES,icon:"secured"}}]}]},{path:"/login",name:"login",component:ze},{path:"/403",name:"not-allowed",component:st},{path:"/:pathMatch(.*)*",name:"not-found",component:et}],W=ae({history:ie(),strict:!0,routes:V,scrollBehavior:()=>({top:0,left:0})}),N=["login","not-found","not-allowed"];W.beforeEach((e,n,t)=>{const r=w();if(r.token||(N.indexOf(e.name)!==-1?t():t(`/login? redirect= ${e.path}`)),r.token&&e.path==="/login"&&t({name:"dashboard"}),e.name){const s=!I().permissionRouteNamesList.includes(e.name);r.token&&s&&N.indexOf(e.name)!==-1&&t({name:"not-allowed"})}t()});const ot=e=>{var n;return((n=x().currentUser)==null?void 0:n.permissions.indexOf(e))===-1},rt={mounted(e,{value:n}){var t;ot(n)&&((t=e.parentNode)==null||t.removeChild(e))}},R=ce(ge),K=le();K.use(ue);R.use(W);R.use(de);R.use(K);R.use(me,{echarts:_e,h:pe});R.directive("permissiom",rt);R.mount("#app");export{E as P,S as _,b as i,it as p,$e as u};
